# Traffic Sign Recognition

> Build a Traffic Sign Recognition Project

## Overview

The goals / steps of this project are the following:

* Load the data set (see below for links to the project data set)
* Explore, summarize and visualize the data set
* Design, train and test a model architecture
* Use the model to make predictions on new images
* Analyze the softmax probabilities of the new images
* Summarize the results with a written report

## Dataset

### Summary

To calculate summary statistics of the traffic signs data set the `numpy` library was used:

* The size of training set is `34799`
* The size of the validation set is `4410`
* The size of test set is `12630`
* The shape of a traffic sign image is `(32, 32, 3)`
* The number of unique classes/labels in the data set is `43`

### Exploration

![][visualization]

### Augmentation

As a first step, the training data set was augmented with images generated by rotating the initial set by `15` degrees both clockwise and counter-clockwise. This would ensure that the model doesn't overfit the existing data set and improve the classification accuracy on the validation set.

### Pre-Processing

For the pre-processing step, the images were converted to grayscale. Then they were normalized by mapping each value from a `[0, 255]` range to a `[-1.0, 1.0]` range, to assist in learning the parameters.

## Model

### Architecture

The final model is based on the LeNet architecture and is consisted of the following layers:

| Layer | Input | Output | Description |
|:---|:---:|:---:|:---:|
| Convolution | `32x32x1` | `28x28x6` | size `5x5`<br/>stride `1x1`<br/>padding `VALID` |
| ReLU | `28x28x6` | `28x28x6` | - |
| Max pooling | `28x28x6` | `14x14x6` | stride `2x2` |
| Convolution | `14x14x6 ` | `10x10x16 ` | size `5x5`<br/>stride `1x1`<br/>padding `VALID` |
| ReLU | `10x10x16 ` | `10x10x16 ` | - |
| Max pooling | `10x10x16 ` | `5x5x16 ` | stride `2x2` |
| Flatten | `5x5x16` | `400` | - |
| Fully connected | `400` | `120` | - |
| ReLU | `120 ` | `120 ` | - |
| Dropout | `120` | `120` | keep probability `0.75` |
| Fully connected | `120` | `84` | - |
| ReLU | `84 ` | `84 ` | - |
| Dropout | `84 ` | `84 ` | keep probability `0.75` |
| Fully connected | `84 ` | `43 ` | - |

### Training

To train the model, the `Adam` optimizer was used. The batch size was set to `128`, the number of epochs to `10` and the learning rate to `0.001`.

The most significant improvement of the accuracy of the validation set was brought by augmenting the data with additional images rotated `15` degrees. Changing the hyperparameters did not affect the accuracy in any significant way.

### Performance

The final model results were:

* validation set accuracy of **`0.935`**
* test set accuracy of **`0.922`**

## New Images

### Exploration

Here are five German traffic signs found on the web:

![][trafic-signs-web]

The first image might be difficult to classify because it includes part of another sign in the bottom of the image.

### Prediction

Here are the results of the prediction:

| | Truth | Prediction |
|:---:|:---|:---|
| ❌ | 30 km/h | Wild animals crossing |
| ✅ | Yield | Yield |
| ✅ | Slippery road | Slippery road |
| ✅ | Turn right ahead | Turn right ahead |
| ✅ | Roundabout mandatory | Roundabout mandatory |

The model was able to correctly guess 4 of the 5 traffic signs, which gives an accuracy of `0.800`. This compares favorably to the accuracy on the test set, keeping in mind that the images were not rigorously processed (e.g. the traffic signs are not perfectly centered) and represent a real-world environment.

### Top 5 Predictions

##### 30 km/h
| Probability | Prediction |
|:---:|:---|
| `0.575` | Beware of ice/snow |
| `0.255` | Wild animals crossing |
| `0.041` | Slippery road |
| `0.040` | Roundabout mandatory |
| `0.016` | Children crossing |

##### Yield
| Probability | Prediction |
|:---:|:---|
| `1.000` | Yield |
| `0.000` | Priority road |
| `0.000` | Keep left |
| `0.000` | Speed limit (30 km/h) |
| `0.000` | Stop |

##### Slippery road
| Probability | Prediction |
|:---:|:---|
| `0.661` | Slippery road |
| `0.329` | Dangerous curve to the left |
| `0.010` | Road narrows on the right |
| `0.000` | Beware of ice/snow |
| `0.000` | Pedestrians |

##### Turn right ahead
| Probability | Prediction |
|:---:|:---|
| `1.000` | Turn right ahead |
| `0.000` | Roundabout mandatory |
| `0.000` | Right-of-way at the next intersection |
| `0.000` | Vehicles over 3.5 metric tons prohibited |
| `0.000` | Double curve |

##### Roundabout mandatory
| Probability | Prediction |
|:---:|:---|
| `0.632` | Roundabout mandatory |
| `0.135` | Priority road |
| `0.112` | Right-of-way at the next intersection |
| `0.080` | End of no passing by vehicles over 3.5 metric tons |
| `0.031` | Speed limit (30 km/h) |



[//]: # (Image References)
[visualization]: ./examples/visualization.png "Visualization"
[trafic-signs-web]: ./examples/trafic-signs.png "Traffic Signs from the Web"
